#!/bin/bash

# 调试训练脚本 - 启用详细调试输出

echo "======================================================================"
echo "训练调试模式"
echo "======================================================================"
echo ""
echo "将运行训练并输出详细调试信息："
echo "  - 标签分布"
echo "  - 特征统计"
echo "  - 正样本对数量"
echo "  - 梯度检查"
echo "  - 参数更新验证"
echo ""
echo "======================================================================"
echo ""

# 运行训练（启用 debug 标志）
python src/train.py --debug --num-epochs 3

echo ""
echo "======================================================================"
echo "调试运行完成"
echo "======================================================================"
echo ""
echo "请检查上面的输出，特别关注："
echo "  1. 'Positive pairs in batch' - 应该 > 0"
echo "  2. 'Params with grad' - 应该 > 0"
echo "  3. 'Total grad norm' - 应该 > 0"
echo ""
echo "如果所有检查都正常但损失仍不变，可能需要："
echo "  - 进一步增大 batch_size（尝试 64）"
echo "  - 增大学习率（尝试 5e-4 或 1e-3）"
echo "  - 检查数据质量"
echo ""
